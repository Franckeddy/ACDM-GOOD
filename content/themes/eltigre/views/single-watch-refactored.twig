{% extends "base.twig" %}

{% block content %}
	{% for post in posts %}
		<!-- ===== DESKTOP ===== -->
		<section class="product desktop-only pt-2.5 md:pt-8 pb-10 md:pb-0">
			<div class="container">
				<div class="grid grid-cols-24 gap-2 md:gap-5">
					
					<!-- HEADER MOBILE ONLY -->
					<div class="product__header col-span-24 flex flex-col items-center md:hidden">
						<h2 class="product__title break-words text-70 flex flex-col mb-5">
							{% if post.custom_fields.brand %}
								<a href="{{ post.custom_fields.brand_url }}" class="text-10 text-grey mb-2.5">
									{{ post.custom_fields.brand }}
								</a>
							{% endif %}
							{{ post.title }}
						</h2>
						{% if post.custom_fields.sold %}
							<span class="text-12 ff-decimal text-grey text-center mb-2.5">Sold</span>
						{% endif %}
					</div>

					<!-- IMAGES GALLERY - LEFT COLUMN -->
					<div class="product__images col-span-24 md:col-span-15">
						<div class="md:sticky js-sticky md:pb-36" style="top: 139px;">
							<div class="gallery-container">
								<div class="gallery-wrapper md:grid md:grid-cols-24 md:gap-3.5">
									
									{% if post.images is not empty %}
										<!-- IMAGE PRINCIPALE -->
										<div class="gallery-item col-span-24 js-gallery-item" 
											data-src="{{ Image(post.images[0]).src }}"
											data-width="2560" 
											data-height="2560">
											<figure class="figure bg-black">
												<div class="figure__holder relative" style="padding: 0 0 100%">
													<a href="{{ Image(post.images[0]).src }}" data-lightbox="watches">
														<img 
															class="absolute inset-0 object-cover h-full w-full"
															src="{{ Image(post.images[0]).src }}"
															alt="{{ Image(post.images[0]).alt }}"
															width="1600" 
															height="1600"
														/>
													</a>
												</div>
											</figure>
										</div>

										<!-- IMAGES SECONDAIRES (GRILLE) -->
										{% if post.images|length > 1 %}
											{% for key, galerie in post.images %}
												{% if key > 0 %}
													<div class="gallery-item md:col-span-12 js-gallery-item" 
														data-src="{{ Image(galerie).src }}"
														data-width="2560" 
														data-height="2560">
														<figure class="figure bg-black">
															<div class="figure__holder relative" style="padding: 0 0 100%">
																<a href="{{ Image(galerie).src }}" data-lightbox="watches">
																	<img 
																		class="absolute inset-0 object-cover h-full w-full"
																		src="{{ Image(galerie).src }}"
																		alt="{{ Image(galerie).alt }}"
																		width="1600" 
																		height="1600"
																	/>
																</a>
															</div>
														</figure>
													</div>
												{% endif %}
											{% endfor %}
										{% endif %}

									{% else %}
										<!-- FALLBACK SI PAS D'IMAGES -->
										<div class="gallery-item col-span-24">
											<figure class="figure bg-black">
												<div class="figure__holder relative" style="padding: 0 0 100%">
													<a href="{{ Image(post.thumbnail).src }}" data-lightbox="watch">
														<img 
															class="absolute inset-0 object-cover h-full w-full"
															src="{{ Image(post.thumbnail).src }}"
															alt="{{ Image(post.thumbnail).alt }}"
															width="1600" 
															height="1600"
														/>
													</a>
												</div>
											</figure>
										</div>
									{% endif %}

								</div>
							</div>
						</div>
					</div>

					<!-- PRODUCT DETAILS - RIGHT COLUMN -->
					<div class="product__details col-span-24 md:col-span-7 md:col-start-17 md:pt-10">
						<div class="md:sticky js-sticky md:pb-36" style="top: 139px;">
							
							<!-- HEADER DESKTOP ONLY -->
							<div class="hidden md:flex flex-col">
								<h2 class="product__title break-words text-70 flex flex-col mb-5">
									{% if post.custom_fields.brand %}
										<a href="{{ post.custom_fields.brand_url }}" class="text-10 text-grey mb-2.5">
											{{ post.custom_fields.brand }}
										</a>
									{% endif %}
									{{ post.title }}
								</h2>
							</div>

							<!-- DESCRIPTION -->
							<div class="product__details__description text-14 mb-12 md:mb-16">
								{{ post.content }}

								<!-- ACF CONTENT -->
								{% if post.custom_fields.long_title or post.custom_fields.long %}
									<div class="acf-section mt-6">
										{% if post.custom_fields.long_title %}
											<h3 class="text-16 font-semibold mb-3">{{ post.custom_fields.long_title }}</h3>
										{% endif %}
										{% if post.custom_fields.long %}
											{{ post.custom_fields.long|raw }}
										{% endif %}
									</div>
								{% endif %}

								{% if post.custom_fields.short_title or post.custom_fields.short %}
									<div class="acf-section mt-6">
										{% if post.custom_fields.short_title %}
											<h3 class="text-16 font-semibold mb-3">{{ post.custom_fields.short_title }}</h3>
										{% endif %}
										{% if post.custom_fields.short %}
											{{ post.custom_fields.short|raw }}
										{% endif %}
									</div>
								{% endif %}
							</div>

							<!-- TOGGLES ACCORDIONS -->
							<div class="product__details__toggles">
								
								<!-- SPECIFICATIONS TOGGLE -->
								<div class="toggle flex flex-col pb-5 border-t border-grey-light">
									<h3 class="toggle__header js-toggle pt-5 text-10 relative cursor-pointer">
										Specifications
										<i class="toggle__header__icon absolute right-0 top-5">
											<span class="block w-3 h-px bg-current"></span>
											<span class="block w-3 h-px bg-current transform rotate-90 -mt-px"></span>
										</i>
									</h3>
									<div class="toggle__content text-12 hidden">
										<div class="mt-3 flex">
											<ul class="w-full">
												{% if post.custom_fields.caliber %}
													<li class="flex items-center mb-2">
														<span class="w-5/12 text-10 text-grey">Calibre</span>
														<span class="w-7/12 text-12">{{ post.custom_fields.caliber }}</span>
													</li>
												{% endif %}
												{% if post.custom_fields.year %}
													<li class="flex items-center mb-2">
														<span class="w-5/12 text-10 text-grey">Année</span>
														<span class="w-7/12 text-12">{{ post.custom_fields.year }}</span>
													</li>
												{% endif %}
												{% if post.custom_fields.case_material %}
													<li class="flex items-center mb-2">
														<span class="w-5/12 text-10 text-grey">Case Material</span>
														<span class="w-7/12 text-12">{{ post.custom_fields.case_material }}</span>
													</li>
												{% endif %}
												{% if post.custom_fields.reference %}
													<li class="flex items-center mb-2">
														<span class="w-5/12 text-10 text-grey">Reference</span>
														<span class="w-7/12 text-12">{{ post.custom_fields.reference }}</span>
													</li>
												{% endif %}
												{% if post.custom_fields.diameter %}
													<li class="flex items-center mb-2">
														<span class="w-5/12 text-10 text-grey">Diamètre</span>
														<span class="w-7/12 text-12">{{ post.custom_fields.diameter }}</span>
													</li>
												{% endif %}
											</ul>
										</div>
									</div>
								</div>
								<!-- WARRANTY TOGGLE (si besoin) -->
								<div class="toggle flex flex-col pb-5 border-t border-grey-light">
									<h3 class="toggle__header js-toggle pt-5 text-10 relative cursor-pointer">
										Garantie & Services
										<i class="toggle__header__icon absolute right-0 top-5">
											<span class="block w-3 h-px bg-current"></span>
											<span class="block w-3 h-px bg-current transform rotate-90 -mt-px"></span>
										</i>
									</h3>
									<div class="toggle__content text-12 hidden">
										<div class="mt-3">
											<ul>
												<li>Montre révisée et garantie 3 ans par notre atelier.</li>
											</ul>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>

		<!-- ===== MOBILE VERSION ===== -->
		<section class="product mobile-only">
			<div class="container px-4 py-6">
				
				<!-- MOBILE CAROUSEL -->
				<div class="mobile-carousel mb-6">
					<div class="mobile-carousel__track">
						{% if post.images is not empty %}
							{% for galerie in post.images %}
								<div class="mobile-carousel__slide">
									<a href="{{ Image(galerie).src }}" data-lightbox="watches-mobile">
										<img
											src="{{ Image(galerie).src }}"
											alt="{{ Image(galerie).alt }}"
											loading="lazy"
											class="w-full h-auto"
										/>
									</a>
								</div>
							{% endfor %}
						{% else %}
							<div class="mobile-carousel__slide">
								<a href="{{ Image(post.thumbnail).src }}" data-lightbox="watch-mobile">
									<img
										src="{{ Image(post.thumbnail).src }}"
										alt="{{ Image(post.thumbnail).alt }}"
										loading="lazy"
										class="w-full h-auto"
									/>
								</a>
							</div>
						{% endif %}
					</div>
				</div>

				<!-- MOBILE CONTENT -->
				<h1 class="text-24 font-bold mb-4">{{ post.title }}</h1>
				
				{% if post.custom_fields.sold %}
					<span class="inline-block bg-grey text-white px-4 py-2 mb-4">Sold</span>
				{% elseif post.custom_fields.price %}
					<div class="text-20 font-bold mb-4">€{{ post.custom_fields.price }}</div>
				{% endif %}

				<div class="content text-14 mb-6">
					{{ post.content }}
				</div>

				{% if not post.custom_fields.sold %}
					<div class="flex gap-3 mb-6">
						<a class="button is-primary flex-1 text-center" href="{{ interest.url }}">{{ interest.label }}</a>
						<a class="button is-secondary flex-1 text-center" href="{{ watches.url }}">{{ watches.label }}</a>
					</div>
				{% endif %}

			</div>
		</section>

		<!-- Same Spirit Section -->
		{% include 'partial/same-spirit.twig' with { post: post } only %}

	{% endfor %}
{% endblock %}
